extends base.pug

block content 
    //- ì‹œì²­ì¤‘ì¸ ë¹„ë””ì˜¤ IDë¥¼ ê°€ì ¸ì˜¤ê¸°ìœ„í•´ data-idì— video._idë¥¼ ì”€. 
    //- ì´ëŸ¬ë©´ javascriptíŒŒì¼ì—ì„œ #videoContainerë¥¼ ê°€ì ¸ì˜¨í›„ videoContainer.dataset.idë¡œ videoì•„ì´ë””ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ
    div#videoContainer(data-id=video._id)
        if isFlyIo
            video(src=video.fileUrl,crossorigin,width=1200,height=675)
        else
            video(src="/" + video.fileUrl,width=1200,height=675) 
        div#videoControls.videoControls.showing
            div.videoControls__play
                span#play.videoControls__playBtn
                    i.fas.fa-play
                div.videoControls__time
                    span#currentTime 00:00
                    span  / 
                    span#totalTime 00:00
            input(type="range", step="1", value=0,min="0")#timeline.videoControls__timeline
            div.videoControls__volume
                input(type="range", step="0.01", value=0.5,min="0",max="1")#volume
                span#mute
                    i.fas.fa-volume-up
            div 
                span#fullScreen
                    i.fas.fa-expand
    //- if String(video.owner._id) === String (loggedInUser._id)
    div.video__data
        div.video__data-info 
            p.video__data-hashtag #{video.hashtags}
            h1.video__data-title #{video.title}
            div.video__data-meta
                span.video__data-meta__view #{video.meta.views} #{video.meta.views > 1 ? "views" : "view"} â€¢ 
                span.video__data-meta__date=new Date(video.createdAt).toLocaleDateString("canada")
        div.video__data-like
            button.video__data-like__btn
                span ğŸ¤
    div.video__owner-data
        a(href=`/users/${video.owner._id}`)
            if !video.owner.avatarUrl
                div.header__avatar--empty.avatar-m
                    i.fas.fa-user
            else
                if isFlyIo
                    img.video__owner-data__avatar(src=video.owner.avatarUrl,crossorigin)
                else 
                    img.video__owner-data__avatar(src="/" + video.owner.avatarUrl)
        div.video__owner-data__info
            div.video__owner-data__info-name
                a(href=`/users/${video.owner._id}`)
                    p #{video.owner.name}
            div.video__owner-data__info-sub
                small 0 Subscriber
    div.video__data-description
        p #{video.description}
        //- h4 #{video.views} #{video.views === 1 ? "view" : "views"}
    
    if String(loggedInUser._id) === String(video.owner._id)
        a(href=`${video.id}/edit`) edit Video &rarr;
        br
        a(href=`${video.id}/delete`) delete Video &rarr;
    div.video__comments-section
        if loggedIn
            div.video__comments-add__container
                div.video__comments-user
                    if !loggedInUser.avatarUrl
                        div.header__avatar--empty.avatar-s
                            i.fas.fa-user
                    else
                        if isFlyIo
                            img.video__comment-avatar(src=loggedInUser.avatarUrl,crossorigin)
                        else 
                            img.video__comment-avatar(src="/" + loggedInUser.avatarUrl)
                form.video__comments-form#commentForm
                    textarea(cols="30", rows="10", placeholder="Write a nice comment...")
                    button COMMENT
        div.video__comments
            ul
                //- each comment in comments.reverse()
                each comment in video.comments.reverse()
                    li.video__comment(data-id=comment._id)
                        div.video__comment-added
                            div.video__comment-added__avatar
                                a(href=`/users/${comment.owner._id}`)
                                    if !comment.owner.avatarUrl
                                        div.video__comment-avatar__empty.avatar-s
                                            i.fas.fa-user
                                    else
                                        if isFlyIo
                                            img.video__comment-avatar(src=comment.owner.avatarUrl,crossorigin)
                                        else 
                                            img.video__comment-avatar(src="/" + comment.owner.avatarUrl)
                            div.video__comment-added__info
                                div.video-comment-added__info-main
                                    h4 #{comment.owner.username} 
                                    span #{new Date(comment.createdAt).toLocaleDateString("canada")}
                                span #{comment.text}
                        if String(loggedInUser._id) === String(comment.owner._id)
                            button.video__comment-deleteBtn
                                span="âŒ"
    block javascript 
         script(src="/static/js/videoPlayer.js")
         script(src="/static/js/likeVideo.js")
         if loggedIn
            script(src="/static/js/commentSection.js")
//- ë¡œê·¸ì¸í•˜ì§€ì•Šìœ¼ë©´ comment formì´ ì•ˆë³´ì´ë‹ˆê¹Œ ì–´ì°¨í”¼ commentSection.jsíŒŒì¼ì—ì„œ
//- form ë“± íƒœê·¸ë“¤ì„ ê°€ì ¸ì˜¤ì§€ ëª»í•¨. ê·¸ë ‡ê¸°ì— ë¡œê·¸ì¸í—€ì„ ê²½ìš°ì—ë§Œ commentSection.jsíŒŒì¼ì„ ì‚¬ìš©
//- í´ë”ëª…static = frontendí´ë”ì™€ ë™ì¼
//- ë‚´ê°€ ê·¸ë ‡ê²Œ ì„¤ì¡í–ˆê¸°ë•Œë¬¸